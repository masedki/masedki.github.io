<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Phénomène de surajustement, validation croisée prise en main de R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/ionicons-2.0.1/css/ionicons.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}

.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Acceuil</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="ion ion-easel"></span>
     
    Enseignements
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">M2R santé publique</li>
    <li>
      <a href="MANprobastat.html">Mise à niveau probabilité et statistiques</a>
    </li>
    <li>
      <a href="MANmatrice.html">Mise à niveau Matrices</a>
    </li>
    <li>
      <a href="bootstrap.html">Introduction à bootstap</a>
    </li>
    <li>
      <a href="ds.html">Démarche Statistique</a>
    </li>
    <li>
      <a href="ml.html">Modèle linéaire</a>
    </li>
    <li>
      <a href="statmath.html">Statistique mathématique</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">M2 MathSV</li>
    <li>
      <a href="genpops.html">Modèles de génétique des populations neutre</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">MOOC d'introduction à la statistique avec R</li>
    <li>
      <a href="devoir.html">Devoir ENS 2016-2017</a>
    </li>
    <li class="dropdown-header">Inserm</li>
    <li>
      <a href="IntroDataScience.html">Introduction aux datasciences pour la recherche biomédicale</a>
    </li>
  </ul>
</li>
<li>
  <a href="recherche.html">Recherche</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="ion ion-settings"></span>
     
    Packages et logiciels
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Model selection in model-based clustering</li>
    <li>
      <a href="VarSelLCM.html">Model selection in mixed data clustering and ICL optimization</a>
    </li>
    <li>
      <a href="SelvarMix.html">Lasso regularization</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Model Selection in Binary data</li>
    <li>
      <a href="MHTrajectoryR.html">Logistic binary data regression</a>
    </li>
    <li>
      <a href="MvBinary.html">Modeling high-dimensional binary data</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Phénomène de surajustement, validation croisée prise en main de R</h1>

</div>


<p>Nous avons illustré le phénomène de surajustement (<em>overfitting</em> en anglais) dans le contexte d’une régression par les knn. Dans cette partie, nous allons étudier le phénomène dit de “overfitting” dans le contexte de sélection de modèle. Nous avons un jeu de données qui semble issu d’une fonction polynomiale et nous allons sélectionner le degré du polynôme pour la régression.</p>
<div id="echantillon-apprentissage-test" class="section level3">
<h3>Échantillon apprentissage-test</h3>
<ul>
<li>Simulation d’un jeu de données</li>
</ul>
<pre class="r"><code># Examples of training data
# 150 standard-Gaussian X&#39;s
ntr &lt;- 150
x = rnorm(ntr)
# Quadratic Y&#39;s
y = 2.5*x^2 - 0.5*x + rnorm(ntr)</code></pre>
<ul>
<li>Un peu de visualisation</li>
</ul>
<pre class="r"><code># Initial plot of training data plus true regression curve
plot(x,y,  pch=16, col=8)
curve(2.5*x^2-0.5*x,add=TRUE)</code></pre>
<p><img src="overfit_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<ul>
<li>Ajustons deux modèles basiques, la constante et la droite de régression linéaire simple</li>
</ul>
<pre class="r"><code>plot(x,y,  pch=16, col=8)
curve(2.5*x^2-0.5*x,add=TRUE)
y.0 = lm(y ~ 1)
abline(h=y.0$coefficients[1])
d = seq(min(x),max(x),length.out=200)
degree = 1
fm = lm(y ~ poly(x,degree))
assign(paste(&quot;y&quot;,degree,sep=&quot;.&quot;), fm)
# Plot them, with different line types
lines(d, predict(fm,data.frame(x=d)),lty=(degree+1))</code></pre>
<p><img src="overfit_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<ul>
<li><p>Ajuster et ajouter les polynômes allant de 1 à 9</p></li>
<li><p>Calculer et tracer l’erreur d’apprentissage en fonction de la complexté du modèle (ici degré du polynôme)</p></li>
<li><p>Simuler un jeu de données test de taille <span class="math inline">\(150\)</span> et l’ajouter à la figure précédente (avec une autre couleur)</p></li>
<li><p>Calculer l’erreur de prédiction sur le jeu de données test en fonction du degré du polynôme et le comparer à l’erreur d’apprentissage</p></li>
</ul>
</div>
<div id="validation-croisee-5-folds" class="section level3">
<h3>Validation croisée <span class="math inline">\(5\)</span> folds</h3>
<ul>
<li><p>Répliquer 5 fois : simuler un échantillon test et tracer les erreurs de prédition en fonction du degré du polyôme.</p></li>
<li><p>Simuler un jeu de données de taille <span class="math inline">\(500\)</span>, à l’aide d’une validation croisée à <span class="math inline">\(5\)</span> folds, déterminer le degré optimal du polynôme au sens de l’erreur de prédiction</p></li>
</ul>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
